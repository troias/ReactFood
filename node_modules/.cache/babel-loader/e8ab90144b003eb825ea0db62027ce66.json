{"ast":null,"code":"import _objectSpread from\"/home/troias/udemy/project-2/01-starting-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/troias/udemy/project-2/01-starting-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/troias/udemy/project-2/01-starting-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/troias/udemy/project-2/01-starting-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState}from\"react\";import classes from\"./Cart.module.css\";import Modal from\"../UI/Modal/Modal\";import CartContext from\"../../contextStore/CartContext\";import CartItem from\"./CartItem/CartItem\";import OrderForm from\"../UI/Forms/OrderForm\";import OrderContext from\"../../contextStore/OrderContext\";import modalsClasses from\"../UI/Forms/Modal.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Cart=function Cart(props){var cartCTX=useContext(CartContext);var orderCTX=useContext(OrderContext);var totalAmount=\"$\".concat(cartCTX.totalAmount.toFixed(2));var hasItems=cartCTX.items.length>0;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),confirmation=_useState2[0],setConfirmation=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),success=_useState4[0],setSuccess=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),valid=_useState6[0],setValid=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSubmitting=_useState8[0],setIsSubmitting=_useState8[1];console.log(\"items\",cartCTX.items);var requestConfig=function requestConfig(order){return{method:\"POST\",headers:{},body:JSON.stringify(order)};};var sendOrderInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(order){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setIsSubmitting(true);_context.next=4;return fetch(\"https://food-app-a635f-default-rtdb.firebaseio.com/order.json\",requestConfig(order));case 4:res=_context.sent;if(res.ok){_context.next=7;break;}throw new Error(\"Request Failed\");case 7:// const data = await res.json()\nsetSuccess(true);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);setSuccess(false);case 13:setIsSubmitting(false);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function sendOrderInfo(_x){return _ref.apply(this,arguments);};}();var orderInfoHandler=function orderInfoHandler(obj){orderCTX.createOrder({name:obj.name,email:obj.email,city:obj.city,postalCode:obj.postalCode,items:cartCTX.items,totalAmount:cartCTX.totalAmount});};var orderCartItems=function orderCartItems(){sendOrderInfo(orderCTX.order);cartCTX.clearCart();};var validityChecker=function validityChecker(value){setValid(value);};var confirmationChecker=function confirmationChecker(value){setConfirmation(value);};var cartItemRemoveHandler=function cartItemRemoveHandler(id){cartCTX.removeItem(id);};var cartItemAddHandler=function cartItemAddHandler(item){cartCTX.addItem(_objectSpread(_objectSpread({},item),{},{amount:1}));};var cartItems=/*#__PURE__*/_jsx(\"ul\",{className:classes[\"cart-items\"],children:cartCTX.items.map(function(item){return/*#__PURE__*/_jsx(CartItem,{name:item.name,price:item.price,amount:item.amount,onRemove:cartItemRemoveHandler.bind(null,item.id),onAdd:cartItemAddHandler.bind(null,item)},item.id);})});var cartModlaContent=/*#__PURE__*/_jsxs(_Fragment,{children:[cartItems,hasItems&&/*#__PURE__*/_jsx(OrderForm,{onClose:props.onHideCart,valid:validityChecker,orderHandler:orderInfoHandler,confirmation:confirmationChecker}),/*#__PURE__*/_jsxs(\"div\",{className:classes.total,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total Amount\"}),/*#__PURE__*/_jsx(\"span\",{children:totalAmount})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[/*#__PURE__*/_jsxs(\"button\",{className:classes[\"button--alt\"],onClick:props.onHideCart,children:[\" \",\"Close\"]}),hasItems&&valid&&confirmation&&/*#__PURE__*/_jsxs(\"button\",{className:classes.button,onClick:orderCartItems,children:[\" \",\"Order\"]})]})]});var isSubmittingModalContent=/*#__PURE__*/_jsx(\"p\",{children:\" Sending order data\"});var successSubmitted=/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,style:{justifyContent:'center',display:'flex'},children:[\"Order Sent\",/*#__PURE__*/_jsx(\"button\",{className:classes.button,onClick:props.onHideCart,children:\"Close\"})]})});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,{onClose:props.onHideCart,children:[!isSubmitting&&!success&&cartModlaContent,isSubmitting&&isSubmittingModalContent,!isSubmitting&&success&&successSubmitted]})});};export default Cart;","map":{"version":3,"sources":["/home/troias/udemy/project-2/01-starting-project/src/components/Cart/Cart.js"],"names":["React","useContext","useState","classes","Modal","CartContext","CartItem","OrderForm","OrderContext","modalsClasses","Cart","props","cartCTX","orderCTX","totalAmount","toFixed","hasItems","items","length","confirmation","setConfirmation","success","setSuccess","valid","setValid","isSubmitting","setIsSubmitting","console","log","requestConfig","order","method","headers","body","JSON","stringify","sendOrderInfo","fetch","res","ok","Error","orderInfoHandler","obj","createOrder","name","email","city","postalCode","orderCartItems","clearCart","validityChecker","value","confirmationChecker","cartItemRemoveHandler","id","removeItem","cartItemAddHandler","item","addItem","amount","cartItems","map","price","bind","cartModlaContent","onHideCart","total","actions","button","isSubmittingModalContent","successSubmitted","justifyContent","display"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\";\r\nimport classes from \"./Cart.module.css\";\r\nimport Modal from \"../UI/Modal/Modal\";\r\nimport CartContext from \"../../contextStore/CartContext\";\r\nimport CartItem from \"./CartItem/CartItem\";\r\nimport OrderForm from \"../UI/Forms/OrderForm\";\r\nimport OrderContext from \"../../contextStore/OrderContext\";\r\nimport modalsClasses from \"../UI/Forms/Modal.css\";\r\n\r\nconst Cart = (props) => {\r\n  const cartCTX = useContext(CartContext);\r\n  const orderCTX = useContext(OrderContext);\r\n\r\n  const totalAmount = `$${cartCTX.totalAmount.toFixed(2)}`;\r\n  const hasItems = cartCTX.items.length > 0;\r\n\r\n  const [confirmation, setConfirmation] = useState(false);\r\n  const [success, setSuccess] = useState(false);\r\n  const [valid, setValid] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  console.log(\"items\", cartCTX.items)\r\n\r\n  const requestConfig = (order) => {\r\n    return {\r\n      method: \"POST\",\r\n      headers: {},\r\n      body: JSON.stringify(order),\r\n    };\r\n  };\r\n\r\n  const sendOrderInfo = async (order) => {\r\n    try {\r\n      setIsSubmitting(true);\r\n      const res = await fetch(\r\n        \"https://food-app-a635f-default-rtdb.firebaseio.com/order.json\",\r\n        requestConfig(order)\r\n      );\r\n\r\n      if (!res.ok) {\r\n        throw new Error(\"Request Failed\");\r\n      }\r\n      // const data = await res.json()\r\n      setSuccess(true);\r\n      \r\n    } catch (error) {\r\n      setSuccess(false);\r\n    }\r\n    setIsSubmitting(false);\r\n  };\r\n\r\n  const orderInfoHandler = (obj) => {\r\n    orderCTX.createOrder({\r\n      name: obj.name,\r\n      email: obj.email,\r\n      city: obj.city,\r\n      postalCode: obj.postalCode,\r\n      items: cartCTX.items,\r\n      totalAmount: cartCTX.totalAmount,\r\n    });\r\n  \r\n  };\r\n\r\n  const orderCartItems = () => {\r\n    sendOrderInfo(orderCTX.order);\r\n    cartCTX.clearCart()\r\n  };\r\n\r\n  const validityChecker = (value) => {\r\n    setValid(value);\r\n  };\r\n\r\n  const confirmationChecker = (value) => {\r\n    setConfirmation(value);\r\n  };\r\n\r\n  const cartItemRemoveHandler = (id) => {\r\n    cartCTX.removeItem(id);\r\n  };\r\n  const cartItemAddHandler = (item) => {\r\n    cartCTX.addItem({ ...item, amount: 1 });\r\n  };\r\n\r\n  const cartItems = (\r\n    <ul className={classes[`cart-items`]}>\r\n      {cartCTX.items.map((item) => (\r\n        <CartItem\r\n          key={item.id}\r\n          name={item.name}\r\n          price={item.price}\r\n          amount={item.amount}\r\n          onRemove={cartItemRemoveHandler.bind(null, item.id)}\r\n          onAdd={cartItemAddHandler.bind(null, item)}\r\n        />\r\n      ))}\r\n    </ul>\r\n  );\r\n\r\n  const cartModlaContent = (\r\n    <>\r\n      {cartItems}\r\n\r\n      {hasItems && (\r\n        <OrderForm\r\n          onClose={props.onHideCart}\r\n          valid={validityChecker}\r\n          orderHandler={orderInfoHandler}\r\n          confirmation={confirmationChecker}\r\n        />\r\n      )}\r\n\r\n      <div className={classes.total}>\r\n        <span>Total Amount</span>\r\n        <span>{totalAmount}</span>\r\n      </div>\r\n\r\n      <div className={classes.actions}>\r\n        <button className={classes[`button--alt`]} onClick={props.onHideCart}>\r\n          {\" \"}\r\n          Close\r\n        </button>\r\n        {hasItems && valid && confirmation && (\r\n          <button className={classes.button} onClick={orderCartItems}>\r\n            {\" \"}\r\n            Order\r\n          </button>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  const isSubmittingModalContent = <p> Sending order data</p>;\r\n  const successSubmitted = (\r\n    <>\r\n\r\n      <div className={classes.actions} style={{\r\n       justifyContent: 'center', display: 'flex'\r\n      }}>\r\n        Order Sent\r\n        <button className={classes.button} onClick={props.onHideCart}>\r\n          Close\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n  return (\r\n    <>\r\n      <Modal onClose={props.onHideCart}>\r\n        {!isSubmitting && !success && cartModlaContent}\r\n        {isSubmitting && isSubmittingModalContent}\r\n        {!isSubmitting && success && successSubmitted}\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Cart;\r\n"]},"metadata":{},"sourceType":"module"}